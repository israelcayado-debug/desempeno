{% extends "base.html" %}
{% block title %}Importar plantilla | Desempeño{% endblock %}

{% block content %}
  <div class="card" style="max-width:820px;margin:0 auto;">
    <h1 style="margin-top:0;">Importar plantilla (DOCX)</h1>

    {% if error %}
      <p style="color:#b91c1c;">{{ error }}</p>
    {% endif %}
    {% if warning %}
      <p style="color:#b45309;">{{ warning }}</p>
    {% endif %}
    {% if success %}
      <p style="color:#15803d;">{{ success }}</p>
    {% endif %}

    <form method="post" enctype="multipart/form-data" style="display:grid;gap:12px;">
      {% csrf_token %}
      <div>
        <label><strong>Archivo .docx</strong></label><br>
        <input type="file" name="docx" accept=".docx" required>
      </div>
      <div>
        <label><strong>Base code (opcional)</strong></label><br>
        <input type="text" name="base_code" placeholder="P01" value="{{ base_code|default:'' }}">
      </div>
      <div>
        <button class="btn primary" type="submit" name="apply" value="1">Importar</button>
        <a class="btn" href="{% url 'home' %}">Volver</a>
      </div>
    </form>

    {% if parsed %}
      <hr style="margin:18px 0;">
      <h3 style="margin-top:0;">Previsualización</h3>
      <p class="muted" style="margin-top:0;">Plantilla detectada: <strong>{{ parsed.name }}</strong></p>
      {% for sec in parsed.sections %}
        <div style="margin-bottom:12px;">
          <strong>{{ sec.name }}</strong>
          <ul style="margin:6px 0 0 18px;">
            {% for q in sec.questions %}
              <li>{{ q.text }}</li>
            {% endfor %}
          </ul>
        </div>
      {% endfor %}
    {% endif %}
  </div>
{% endblock %}
